--Amal Mohamed
--1/117/2019
--Lab 1

-- 1. Use your Database
use mk_st19


-- 2. Drop the Table if it exists
DROP TABLE IF EXISTS PETOWNER
DROP TABLE IF EXISTS APPOINTMENT
DROP TABLE IF EXISTS CLIENT
DROP TABLE IF EXISTS PET
DROP TABLE IF EXISTS CATEGORY
DROP TABLE IF EXISTS STAFF
DROP TABLE IF EXISTS DOCTOR
DROP TABLE IF EXISTS CLINIC


--3 Create the CATEGORY Table
CREATE TABLE CATEGORY(
CATEGORY_ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
CATEGORY_TITLE VARCHAR(25),
)

-- Create the PET Table
CREATE TABLE PET(
PET_ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
CATEGORY_ID int FOREIGN KEY REFERENCES CATEGORY(CATEGORY_ID),
PET_NAME VARCHAR(25),
PET_DATE_BIRTH DATE,
PET_DATE_JOIN DATE
)

-- Create the CLIENT Table
CREATE TABLE CLIENT(
CLIENT_ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
CLIENT_FIRST_NAME VARCHAR(25),
CLIENT_LAST_NAME VARCHAR(25),
)


-- Create the PETOWNER Table
CREATE TABLE PETOWNER(
CLIENT_ID int FOREIGN KEY REFERENCES CLIENT(CLIENT_ID),
PET_ID int FOREIGN KEY REFERENCES PET (PET_ID),
PRIMARY KEY (CLIENT_ID, PET_ID),
)


-- Create the DOCTOR table 
CREATE TABLE DOCTOR(
DOCTOR_ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
DOCTOR_FIRST_NAME VARCHAR(25),
DOCTOR_LAST_NAME VARCHAR(25),
)


-- Create the CLINIC table 
CREATE TABLE CLINIC(
CLINIC_ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
CLINIC_NAME VARCHAR(25),
)


-- Create the STAFF table 
CREATE TABLE STAFF(
CLINIC_ID int FOREIGN KEY REFERENCES CLINIC(CLINIC_ID),
DOCTOR_ID int FOREIGN KEY REFERENCES DOCTOR(DOCTOR_ID),
PRIMARY KEY (CLINIC_ID, DOCTOR_ID)
)

-- Create Appointment table
CREATE TABLE APPOINTMENT(
APPOINTMENT_ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
PET_ID int FOREIGN KEY REFERENCES PET(PET_ID),
CLIENT_ID int FOREIGN KEY REFERENCES CLIENT(CLIENT_ID),
DOCTOR_ID int FOREIGN KEY REFERENCES DOCTOR(DOCTOR_ID),
CLINIC_ID int FOREIGN KEY REFERENCES CLINIC(CLINIC_ID),
APPOINTMENT_DATE DATE
)

--4 Insert Data into Category
INSERT INTO CATEGORY (CATEGORY_TITLE) 
VALUES ('Dog'), 
	   ('Cat'), 
	   ('Hamster'),
	   ('Fish')

--5 Insert Data into PET
INSERT INTO PET (CATEGORY_ID, PET_NAME, PET_DATE_BIRTH, PET_DATE_JOIN) 
VALUES (1, 'Hucky', convert(DATE,'6/1/1998'), convert(DATE,'8/1/1998')),
(1, 'Sumi', convert(DATE,'10/10/2018'), convert(DATE,'1/4/2011')),
(3, 'Zoe', convert(DATE,'9/24/2018'), convert(DATE,'1/7/2019')),
(2, 'Zoe', convert(DATE,'2/14/2018'), convert(DATE,'2/20/2018')),
(4, 'Neumo', convert(DATE,'4/1/2018'), convert(DATE,'12/20/2018'))

--6 Insert Data into CLIENT
INSERT INTO CLIENT (CLIENT_FIRST_NAME, CLIENT_LAST_NAME) 
VALUES ('Mike','Koenig'), 
('Doug', 'Koenig')

--7 Insert Data into PETOWNER
INSERT INTO PETOWNER( PET_ID, CLIENT_ID)
VALUES (1,1),
	   (3,1),
	   (2,1),
	   (5,2)

--8 Insert Data into Doctor
INSERT INTO DOCTOR(DOCTOR_FIRST_NAME, DOCTOR_LAST_NAME)
VALUES ('Asumi', 'Hiura'),
	   ('Honami', 'Aoyama'),
	   ('Sonomi', 'Ogi')

--9 Insert Data into Clinic
INSERT INTO CLINIC (CLINIC_NAME)
VALUES ('Seattle'),('Bellevue')

--10 Insert Data into Staff
INSERT INTO STAFF(CLINIC_ID,DOCTOR_ID)
Values (1,1),
	   (1,2),
	   (2,3),
	   (1,3)

--11 Insert Data into Appointment
INSERT INTO APPOINTMENT(CLIENT_ID,PET_ID,DOCTOR_ID,CLINIC_ID)
VALUES (1,1,1,1), 
       (1,2,2,2), 
       (2,3,3,1),
	   (2,3,3,2)

--12 Show the Data in Pet
select PET_ID, PET_NAME, PET_DATE_BIRTH, PET_DATE_JOIN from PET

--13 Show the Data from Client
select CLIENT_ID,CLIENT_FIRST_NAME,CLIENT_LAST_NAME from CLIENT

--14 Show the Data from PetOwner
select PET_ID,CLIENT_ID from PETOWNER

--15 Show the Data from Doctor
select DOCTOR_ID, DOCTOR_FIRST_NAME, DOCTOR_LAST_NAME from DOCTOR

--16 Show the data from Clinic
select CLINIC_ID,CLINIC_NAME from CLINIC

--17 Show the data from Staff
select  CLINIC_ID,DOCTOR_ID from STAFF

--18 Show the data from appointment
select APPOINTMENT_ID, PET_ID, CLIENT_ID, DOCTOR_ID, CLINIC_ID, APPOINTMENT_DATE from APPOINTMENT     

--19 JOIN Client with pet and return the Pet Name, and Category
select PET_NAME, CATEGORY_TITLE, PET_DATE_JOIN from PET INNER JOIN CATEGORY on CATEGORY.CATEGORY_ID = PET.CATEGORY_ID



