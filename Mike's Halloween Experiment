-- 1. Use your DB
USE mk_st19

-- 2. Drop Tables 
DROP TABLE IF EXISTS CANDY_BAG
DROP TABLE IF EXISTS CANDY
DROP TABLE IF EXISTS PARTICIPANT
DROP TABLE IF EXISTS COSTUME
DROP TABLE IF EXISTS COSTUME_TYPE
DROP TABLE IF EXISTS AGE_GROUP

--3. Create all Tables

CREATE TABLE COSTUME_TYPE(
COSTUME_TYPE_ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
COSTUME_TYPE_TITLE VARCHAR(25)
)

CREATE TABLE COSTUME(
COSTUME_ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY, 
COSTUME_TYPE_ID INT FOREIGN KEY REFERENCES COSTUME_TYPE(COSTUME_TYPE_ID),
COSTUME_NAME VARCHAR(25)
)

CREATE TABLE PARTICIPANT(
PARTICIPANT_ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
COSTUME_ID INT FOREIGN KEY REFERENCES COSTUME(COSTUME_ID),
PARTICIPANT_NAME VARCHAR(25),
PARTICIPANT_AGE INT
)

CREATE TABLE CANDY(
CANDY_ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
CANDY_NAME VARCHAR(25)
)

CREATE TABLE CANDY_BAG(
CANDY_ID INT FOREIGN KEY REFERENCES CANDY(CANDY_ID),
PARTICIPANT_ID INT FOREIGN KEY REFERENCES PARTICIPANT(PARTICIPANT_ID),
CANDY_COUNT INT,
PRIMARY KEY(CANDY_ID,PARTICIPANT_ID)
)

CREATE TABLE AGE_GROUP(
AGE_GROUP_ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
AGE_GROUP_TITLE VARCHAR(25),
AGE_GROUP_LOWER INT,
AGE_GROUP_UPPER INT
)
-- 4. Insert values into the Age Group Table
INSERT INTO AGE_GROUP(AGE_GROUP_TITLE,AGE_GROUP_LOWER,AGE_GROUP_UPPER)
VALUES('Pre-K', 0, 4),
	  ('K',5,6),
	  ('Elementary',7,12),
	  ('Middle School', 13, 15),
	  ('Highschool',16,18),
	  ('College',19,25),
	  ('Adult',26,60),
	  ('Senior',61,200)


-- 5. Insert values into the Costume Type Table
INSERT INTO COSTUME_TYPE(COSTUME_TYPE_TITLE)
VALUES('Animal'),
	  ('Superhero'),
	  ('Superhero'),
	  ('Profession'),
	  ('Animal'),
	  ('Monster'),
	  ('Animal'),
	  ('Monster')
-- 6. Insert values into the Candy Table
INSERT INTO CANDY(CANDY_NAME)
VALUES('Snickers'),
	  ('M&M'),
	  ('Bubble Gum'),
	  ('Twizzlers'),
	  ('Twix'),
	  ('Dental Floss')

---7. Insert values into the Costume Table
INSERT INTO COSTUME (COSTUME_NAME)
VALUES('an otter'),
	  ('Spiderman'),
	  ('Superman'),
	  ('a Doctor'),
	  ('a Dog'),
	  ('Frankenstein'),
	  ('a Penguin'),
	  ('a Boggart')
 
 --8. Insert Values into the Participant Table
INSERT INTO PARTICIPANT(PARTICIPANT_NAME,PARTICIPANT_AGE)
VALUES('Mike',3),
	  ('Doug',6),
	  ('Sue',9),
	  ('Jean',15),
	  ('Daren',16),
	  ('Jake',4),
	  ('Dani',10),
	  ('Tim',7)

-- 9. Select a list of All Participant Names with Age (not age group)
SELECT PARTICIPANT_NAME,PARTICIPANT_AGE FROM PARTICIPANT

-- 10. Select a list of the Costumes Names with Type Title (JOIN)
SELECT COSTUME_NAME, COSTUME_TYPE_TITLE FROM COSTUME INNER JOIN COSTUME_TYPE ON COSTUME_TYPE.COSTUME_TYPE_ID = COSTUME.COSTUME_ID

-- 11. Select a list of the Candy Names
SELECT CANDY_NAME FROM CANDY

-- 12. List of Age Groups Title, Lower and Upper Ranges
SELECT AGE_GROUP_TITLE,AGE_GROUP_LOWER,AGE_GROUP_UPPER FROM AGE_GROUP

--13. List of Participant Names, Costume Name, Costume Type Title (JOIN)
SELECT PARTICIPANT_NAME, COSTUME_NAME, COSTUME_TYPE_TITLE FROM COSTUME 
JOIN COSTUME_TYPE ON COSTUME_TYPE.COSTUME_TYPE_ID = COSTUME.COSTUME_TYPE_ID
JOIN PARTICIPANT ON PARTICIPANT.PARTICIPANT_ID = COSTUME.COSTUME_ID

-- 14. List of Participant Names, Age, Age Group Title ( JOIN using the BETWEEN syntax with Lower and Upper. look up syntax)
SELECT  PARTICIPANT_NAME, PARTICIPANT_AGE,AGE_GROUP_TITLE FROM PARTICIPANT INNER JOIN AGE_GROUP ON PARTICIPANT.PARTICIPANT_AGE BETWEEN AGE_GROUP_LOWER AND AGE_GROUP_UPPER


